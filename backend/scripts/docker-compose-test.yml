version: "3"
services: 
    api:
        image: librarybackend:test
        ports: 
          - "5000:5000"
    testrunner:
        image: librarybackend:test
        depends_on: 
          - api
        command: 
          - "./deployment/wait-for-it.sh"
          - "api:5000"
          - "-t"
          - "0"
          - "--"
          - "pytest"
          - "./tests"
        environment: 
          - FLASK_TEST_SERVER=api
          - FLASK_TEST_PORT=5000
        